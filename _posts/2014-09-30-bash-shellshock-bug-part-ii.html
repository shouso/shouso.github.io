---
layout: post
title: Bash Shellshock Bug Part II
date: '2014-09-30T09:52:00.000-07:00'
author: Shouso
tags:
- bash bug
- firewall
- shellshock
- firestarter
- gufw
- ufw
- bash
- shell script
- shell
modified_time: '2014-10-01T02:39:34.185-07:00'
thumbnail: http://2.bp.blogspot.com/-hKhSbJVyVBQ/VCreXKzKItI/AAAAAAAACwM/qPqpJNkFQkk/s72-c/2014-09-30-234236_1366x768_scrot.png
blogger_id: tag:blogger.com,1999:blog-1667078280118069816.post-3625882467441993261
blogger_orig_url: https://www.naciro.xyz/2014/09/bash-shellshock-bug-part-ii.html
---

Mengingat potensi bahaya Shellshock, sebaiknya kita ikutin pepatah lama yang bunyinya kira-kira gini<br /><br />&nbsp;&nbsp;&nbsp; "sedia payung sebelum kecipratan comberan" :D<br /><br />alias kita jaga-jaga aja, siapa tau pas lagi online kek nulis blog ini tetiba ada skript kiddies yang iseng ngescan dan misalnya nemu Debian saya belum ke patch dan dipasangin backdoor... kan ribet nantinya... makanya sebaiknya lakukan langkah-langkah pencegahan sebagai berikut ini :<br /><br />1. cek dulu apakah bash anda rentan serangan, menurut shellshocker.net minimal ada 5 jenis tes yang mesti dilakukan untuk memastikan bash anda udah di patch dan relatif aman,&nbsp; tapi menurut saya kalo di Debian Wheezy cukup test pertama yakni :<br /><br />Exploit 1 (<a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6271" target="_blank">CVE-2014-6271</a>), ngeceknya pake skript ini<br /><pre>&nbsp;</pre><pre><b>env x='() { :;}; echo vulnerable' bash -c "echo tis ist a tet"</b></pre><pre>&nbsp;</pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">kalo hasilnya vulnerable tis ist a tet", segera di upgrade bash ente, biasanya untuk distro&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">besar udah menyediakan update.</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">Jika di Debian, cukup apt-get update dilanjutkan apt-get upgrade, kalo cuma mo upgade bashnya tinggal install bash nya aja&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">apt-get install --reinstall bash.</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">2. apakah cukup dengan itu? sepertinya ga deh, sementara waktu pensiunkan dulu bash ente dari</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">standar shell yang dipake, caranya install shell yang lain, atau gunakan dash sebagai shell standar.</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">apt-get install zsh atau apt-get install mksh</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">lalu ganti shell standar pake perintah chsh</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">shouso :~$ chsh<br />Password: <br />Changing the login shell for shouso<br />Enter the new value, or press return for the default<br />        Login Shell [/bin/sh]: /bin/zsh&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">&nbsp;</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: small;">lakukan juga untuk root anda. setelah itu logout dan login lagi. maka shell anda akan berubah menjadi zsh</span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><br /></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: &quot;Courier New&quot;, Courier, monospace;"><span style="font-size: small;">3. Cukup dengan itu? sepertinya tidak sih, karena ada kemungkinan skript yang make bash tetep bisa jalan.</span></span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: &quot;Courier New&quot;, Courier, monospace;"><span style="font-size: small;">Bisa aja sih untuk sementara kita bikinin skrip yang dijalanin tiap menit untuk ngecek ada bash yang jalan ga? terus di kill. </span></span></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><br /></span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;">skriptnya gampang aja kok, misalnya dikasih nama killbash.sh, isi dengan ini :</span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;">&nbsp;</span></pre><pre><span style="font-family: Arial,Helvetica,sans-serif;"><br /></span></pre>#!/bin/zsh<br /><br />PID=`ps -ef | grep "/bin/bash/" | awk ' {print $2}' | xargs kill`<br /><br />if [[ -z "$PID" ]] then<br />killall -9 bash<br />fi&nbsp;&nbsp; <br /><pre>&nbsp;</pre><pre>kasih permission biar bisa dijalankan</pre><pre>chmod +x ./killbash.sh</pre><pre>&nbsp;</pre><pre>terus masukin ke crontab pake perintah&nbsp;</pre><pre>&nbsp;</pre><pre>crontab -e</pre><pre>&nbsp;</pre><pre>tambahkan baris</pre><pre>&nbsp;</pre><pre>*/1 * * * * /home/kamu/killbash.sh</pre><pre>&nbsp;</pre><pre>terus save.</pre><pre></pre><pre>itu akan dijalankan tiap satu menit, klo mo diubah tinggal ganti aja... klo skriptnya ga jalan.. silahkan googling lag :D</pre><pre></pre><pre>4. masih kurang yakin juga, pasang firewall</pre><pre></pre><pre>apt-get install firestarter</pre><pre></pre><pre>terus kasih rule yang rada strict gitu... batasin aliran data yang terkait telnet, xwindows dll.</pre><pre></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-hKhSbJVyVBQ/VCreXKzKItI/AAAAAAAACwM/qPqpJNkFQkk/s1600/2014-09-30-234236_1366x768_scrot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-hKhSbJVyVBQ/VCreXKzKItI/AAAAAAAACwM/qPqpJNkFQkk/s1600/2014-09-30-234236_1366x768_scrot.png" height="223" width="400" /></a></div><pre></pre><pre>&nbsp;</pre><pre>&nbsp;... sudah toh.... sambil nunggu para developer bash ngeberesin bug nya kita ngopi-ngopi duyu...:D</pre><pre></pre><pre>next read :</pre><pre></pre><pre><a href="https://shellshocker.net/">https://shellshocker.net/</a></pre><pre><a href="http://www.commandlinefu.com/commands/view/1138/ps-ef-grep-process-grep-v-grep-awk-print-2-xargs-kill-9">http://www.commandlinefu.com/commands/view/1138/ps-ef-grep-process-grep-v-grep-awk-print-2-xargs-kill-9</a></pre><pre><a href="http://stackoverflow.com/questions/13910087/shell-script-to-capture-process-id-and-kill-it-if-exist">http://stackoverflow.com/questions/13910087/shell-script-to-capture-process-id-and-kill-it-if-exist </a></pre>